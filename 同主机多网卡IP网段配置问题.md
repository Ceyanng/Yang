# 同主机多网卡IP网段配置问题
现在有两台主机，主机A和主机B，主机A上有两张可用网卡，主机A和B通过交换机接入同一局域网，都使用静态IPv4进行路由，探究配置同网段和不同网段会产生的结果
## 主机A两张网卡，首先配置不同网段ip：
ip: `70.167.7.12/16`   iface: `eno3`  

ip: `90.167.9.12/16`   iface: `ens2f0np0`   

### 使用局域网内的另一台主机B:
ip:`70.167.7.4` iface:`ens2f1`  

### B ping A：
`ping 70.167.7.12`  可以ping通   

`ping 90.167.9.12`  destination host unreachable  

### A ping B：
`ping 70.167.7.4`   可以ping通  

`ping -I 70.167.7.12  70.167.7.4` 可以ping通   

`ping -I 90.167.9.12  70.167.7.4` 可以ping通  


### A的ARP表：

 `70.167.7.4` 的mac地址是B的ens2f1网卡mac地址（at），通过自己的eno3网卡（on） 

90.167.9.4 的mac地址<imcomplete> ，通过自己的ens2f0np0   

B也是如此
## 主机A两张网卡，配置同网段ip
	ip:`70.167.7.12/16`     iface: `eno3`
	ip:`70.167.71.12/16`    iface: `ens2f0np0`   
 
### 使用局域网内的另一台主机B:   
ip:`70.167.7.4` iface:`ens2f1` 
### B ping A：
`ping 70.167.7.12` 可以ping通   

`ping 70.167.71.12` 也可以ping通   

### A ping B:
`ping 70.167.7.4` 可以ping通  

`ping -s 70.167.7.12  70.167.7.4` 可以ping通 （-I 使用的源地址）  

`ping -s 70.167.71.12  70.167.7.4` 可以ping通  

### A的ARP表：
70.167.7.4 的mac地址是B的ens2f1网卡mac地址（at），通过自己的ens2f0np0网卡（on）   

**所以实际上在A的视角我要给B发信息，我不会两个网卡都用，只会用其中一个，用的是metric值更小的那个iface**   

### B的ARP表：
70.167.7.12的mac地址是B的ens2f0np0网卡的mac地址，通过自己的ens2f1   

70.167.71.12的mac地址同样是B的ens2f0np0网卡的mac地址，通过自己的ens2f1  

**在B的视角，我要给两个不同的ip发信息，但这两个ip的mac地址是同一个网卡**

## 总结
所以要给其分配不同的网段，这样就可以根据目的网段的不同而选择不同的网卡。  


分配在同一个网段的重要隐患在于os会自动选择后连接的同网段网卡作为默认路由的接口，并将其写在路由表中，一旦后连接的同网段网卡断开连接，在重启网络之前也无法自动恢复到之前的网卡接口。

